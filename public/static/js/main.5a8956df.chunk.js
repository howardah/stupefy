(this.webpackJsonpstupefy=this.webpackJsonpstupefy||[]).push([[0],{143:function(e,a,t){},210:function(e,a,t){e.exports=t(624)},214:function(e,a,t){},215:function(e,a,t){},216:function(e,a,t){},287:function(e,a,t){},288:function(e,a,t){},318:function(e,a){},321:function(e,a,t){},326:function(e,a,t){},354:function(e,a,t){},622:function(e,a,t){},623:function(e,a,t){},624:function(e,a,t){"use strict";t.r(a);var r=t(0),s=t.n(r),n=t(28),o=t.n(n),i=(t(214),t(4)),c=t(5),l=t(6),u=t(7),d=t(10),p=t(57),h=(t(215),t(2)),m=t(8),y=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).isEmpty=function(e){return""===e},e.playCard=function(){e.props.playCard(e.props.player,e.props.card)},e.style=function(){return void 0===e.props.myCard||e.props.myCard?""===e.props.card.fileName?{}:{backgroundImage:"url('/images/stupefy/"+e.props.card.fileName+".jpg')"}:{}},e.classes=function(){var a="card";return(void 0===e.props.myCard||e.props.myCard)&&(a+=" "+e.props.card.fileName,e.isEmpty(e.props.card.house)||(a+=" "+e.props.card.house),e.isEmpty(e.props.card.fileName)&&(a+=" empty")),a+=" "+e.props.extraClass},e}return Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{onClick:this.playCard,cardname:this.props.card.fileName,className:this.classes(),style:this.style()})}}]),t}(r.Component),f=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={},e}return Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"character"},s.a.createElement("div",{className:this.props.character.fileName+" card "+this.props.extraClass+(this.isEmpty(this.props.character.house)?"":this.props.character.house+" "),style:{backgroundImage:"url('/images/stupefy/characters/"+this.props.character.fileName+".jpg')"},onClick:this.props.playCard}),s.a.createElement("div",{className:"health card"},Array.from(Array(this.props.character.health).keys()).reverse().map((function(e,a){return s.a.createElement("div",{key:a,className:"health wands wands_"+(e+1)})}))))}}]),t}(y),v=function(){function e(a,t){Object(i.a)(this,e),this.cards=a||[],this.discards=t||[]}return Object(c.a)(e,[{key:"getLength",value:function(){return this.cards.length}},{key:"drawCards",value:function(e,a){return a?this.discards.splice(0,e):(0===this.cards.length&&this.shuffle(),this.cards.splice(0,e))}},{key:"drawCard",value:function(e){return e?this.discards.splice(0,1)[0]:(0===this.cards.length&&this.shuffle(),this.cards.splice(0,1)[0])}},{key:"backToTheTop",value:function(e){this.cards.unshift(e)}},{key:"serveCard",value:function(e){this.discards.unshift(e)}},{key:"serveCards",value:function(e){var a;(a=this.discards).splice.apply(a,[0,0].concat(Object(h.a)(e)))}},{key:"copy",value:function(){return[this.cards,this.discards]}},{key:"shuffle",value:function(){for(var e=[].concat(Object(h.a)(this.cards),Object(h.a)(this.discards)),a=e.length-1;a>0;a--){var t=Math.floor(Math.random()*a),r=e[a];e[a]=e[t],e[t]=r}this.cards=e,this.discards=[]}}]),e}(),b=[{fileName:"albus_dumbledore",name:"Albus Dumbledore",house:"G",health:4,"max-health":4,power:{}},{fileName:"arthur_weasley",name:"Arthur Weasley",house:"G",health:4,"max-health":4,power:{}},{fileName:"bellatrix_lestrange",name:"Bellatrix Lestrange",house:"S",health:4,"max-health":4,power:{}},{fileName:"cedric_diggory",name:"Cedric Diggory",house:"H",health:4,"max-health":4,power:{}},{fileName:"dobby",name:"Dobby",house:"",health:4,"max-health":4,power:{}},{fileName:"dolores_umbridge",name:"Dolores Umbridge",house:"S",health:4,"max-health":4,power:{}},{fileName:"draco_malfoy",name:"Draco Malfoy",house:"S",health:3,"max-health":3,power:{}},{fileName:"fenrir_greyback",name:"Fenrir Greyback",house:"S",health:4,"max-health":4,power:{}},{fileName:"fred_and_george",name:"Fred & George Weasley",house:"G",health:4,"max-health":4,power:{}},{fileName:"gilderoy_lockhart",name:"Gilderoy Lockhart",house:"R",health:4,"max-health":4,power:{}},{fileName:"ginny_weasley",name:"Ginny Weasley",house:"G",health:4,"max-health":4,power:{}},{fileName:"harry_potter",name:"Harry Potter",house:"G",health:3,"max-health":4,power:{}},{fileName:"hermione_granger",name:"Hermione Granger",house:"G",health:4,"max-health":4,power:{}},{fileName:"james_potter",name:"James Potter",house:"G",health:4,"max-health":4,power:{}},{fileName:"lily_potter",name:"Lily Potter",house:"G",health:4,"max-health":4,power:{}},{fileName:"lucius_malfoy",name:"Lucius Malfoy",house:"S",health:4,"max-health":4,power:{}},{fileName:"luna_lovegood",name:"Luna Lovegood",house:"R",health:3,"max-health":3,power:{}},{fileName:"mad-eye_moody",name:'Alastor "Mad-Eye" Moody',house:"R",health:4,"max-health":4,power:{}},{fileName:"minerva_mchonagall",name:"Minerva McGonagall",house:"G",health:4,"max-health":4,power:{}},{fileName:"molly_weasley",name:"Molly Weasley",house:"G",health:4,"max-health":4,power:{}},{fileName:"mundungus_fletcher",name:"Mundungus Fletcher",house:"S",health:4,"max-health":4,power:{}},{fileName:"neville_longbottom",name:"Neville Longbottom",house:"G",health:4,"max-health":4,power:{}},{fileName:"nymphadora_tonks",name:"Nymphadora Tonks",house:"H",health:4,"max-health":4,power:{}},{fileName:"peeves",name:"Peeves",house:"",health:3,"max-health":3,power:{}},{fileName:"peter_pettigrew",name:"Peter Pettigrew",house:"G",health:3,"max-health":3,power:{}},{fileName:"remus_lupin",name:"Remus Lupin",house:"G",health:4,"max-health":4,power:{}},{fileName:"ron_weasley",name:"Ron Weasley",house:"G",health:4,"max-health":4,power:{}},{fileName:"rubeus_hagrid",name:"Rubeus Hagrid",house:"G",health:4,"max-health":4,power:{}},{fileName:"severus_snape",name:"Severus Snape",house:"S",health:3,"max-health":3,power:{}},{fileName:"sirius_black",name:"Sirius Black",house:"G",health:4,"max-health":4,power:{}},{fileName:"voldemort",name:"Voldemort",house:"S",health:3,"max-health":3,power:{}}];b.forEach((function(e,a){e.shots=1,e.draw=2,b[a]=e}));var g=new v(function(){var e=Array(82).fill("G",0,20).fill("R",20,41).fill("S",41,61).fill("H",61,82),a=Array(4).fill({name:"accio",power:{}}),t=Array(25).fill({name:"stupefy",power:{}}),r=Array(12).fill({name:"protego",power:{}}),s=Array(3).fill({name:"azkaban",power:{jailed:!0}}),n=Array(6).fill({name:"butterbeer",power:{}}),o=Object(h.a)(Array(4)).map((function(e){return{name:"expelliarmus_"+Math.ceil(3*Math.random()),power:{}}})),i=[{name:"larch_wand",power:{range:4}},{name:"yew_wand",power:{range:4}},{name:"aspen_wand",power:{range:3}},{name:"holly_wand",power:{range:2,"yew-immunity":!0}},{name:"elder_wand",power:{shots:Number.POSITIVE_INFINITY}},{name:"fiendfyre",power:{}},{name:"broomstick",power:{distance:1}},{name:"broomstick",power:{distance:1}},{name:"polyjuice_potion",power:{}},{name:"resurrection_stone",power:{}},{name:"expecto_patronum",power:{}},{name:"wizards_duel",power:{}},{name:"wizards_duel",power:{}},{name:"wizards_duel",power:{}},{name:"weasleys_wizard_weezes",power:{}},{name:"vanishing_cabinet",power:{}},{name:"vanishing_cabinet",power:{}},{name:"invisibility_cloak",power:{}},{name:"felix_felicis",power:{}},{name:"dementors",power:{}},{name:"dementors",power:{}},{name:"apparate",power:{}},{name:"three_broomsticks",power:{}},{name:"honeydukes",power:{}},{name:"honeydukes",power:{}},{name:"garroting_gas",power:{}},{name:"diagon_alley",power:{}},{name:"diagon_alley",power:{}}],c=[].concat(Object(h.a)(a),Object(h.a)(t),Object(h.a)(r),Object(h.a)(s),Object(h.a)(n),i,Object(h.a)(o));return c.forEach((function(a,t){c[t]={id:t,name:a.name,fileName:a.name,power:a.power,house:e.splice(Math.floor(Math.random()*e.length),1)[0]}})),c}()),k=new v(b);g.shuffle(),k.shuffle();k.drawCards(1)[0],g.drawCards(1)[0],g.drawCards(1)[0],g.drawCards(1)[0],k.drawCards(1)[0],g.drawCards(1)[0],g.drawCards(1)[0],k.drawCards(1)[0],g.drawCards(1)[0],g.drawCards(1)[0],k.drawCards(1)[0],g.drawCards(1)[0],g.drawCards(1)[0],k.drawCards(1)[0],g.drawCards(1)[0],g.drawCards(1)[0];var w={id:"",fileName:"",house:"",name:""},C=(t(216),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={},e.checkDistance=function(a){if(0===e.props.player.character.health)return!1;var t=e.props.players.filter((function(e){return e.character.health>0})),r=t.filter((function(a){return a.id===e.props.player_id}))[0],s=t.findIndex((function(a){return a.id===e.props.player.id})),n=1;a&&(n=a);for(var o=0;o<r.tableau.length;o++){var i,c;if(void 0!==(null===(i=r.tableau[o].power)||void 0===i?void 0:i.distance)){var l=r.tableau[o].power.distance;n+=l>0?0:-l}a||void 0!==(null===(c=r.tableau[o].power)||void 0===c?void 0:c.range)&&(n+=r.tableau[o].power.range-1)}"remus_lupin"===r.character.fileName&&n++;for(var u=0;u<e.props.player.tableau.length;u++){var d;if(void 0!==(null===(d=e.props.player.tableau[u].power)||void 0===d?void 0:d.distance)){var p=e.props.player.tableau[u].power.distance;n-=p>0?p:0}}return s<=n||t.length-s<=n},e.playerClasses=function(){var a="player";return a+=0===e.props.index?" this-player":" other-player",e.props.that.deadPlayers.includes(e.props.player.id)&&(a+=" dead","auror"!==e.props.player.role?a+=" "+e.props.player.role.replace(" ","_"):a+=" auror_"+Math.ceil(2*Math.random())),"minister"===e.props.player.role&&(a+=" minister"),"death eater"===e.props.player.role&&"mad-eye_moody"===e.props.players[0].character.fileName&&(a+=" death-eater"),a},e.handClickable=function(a,t){return!(e.props.targets.includes("range")&&!e.checkDistance(1))&&(!(e.props.player.id!==e.props.player_id||!e.props.targets.includes("my-hand"))||!(e.props.player.id===e.props.player_id||!e.props.targets.includes("hand")))},e.tableauClickable=function(a){if("azkaban"===a.fileName)return!1;if(e.props.targets.includes("range")&&!e.checkDistance(1))return!1;if(e.props.player.id===e.props.player_id){if(""!==a.fileName&&e.props.targets.includes("my-tableau"))return!0;if(""===a.fileName&&e.props.targets.includes("my-tableau-empty"))return!0}if(e.props.player.id!==e.props.player_id){if(""!==a.fileName&&e.props.targets.includes("tableau"))return!0;if(""===a.fileName&&e.props.targets.includes("tableau-empty"))return!0}return!1},e.characterClickable=function(){return 0!==e.props.player.character.health&&(!(e.props.targets.includes("range")&&!e.checkDistance(1))&&(!(e.props.targets.includes("wand-range")&&!e.checkDistance())&&(!(e.props.player.id!==e.props.player_id||!e.props.targets.includes("my-character"))||!(e.props.player.id===e.props.player_id||!e.props.targets.includes("characters")))))},e.apparate=function(a){var t=!1;return e.props.targets.includes("between-characters")&&(t=!0),!t||0!==a&&a!==e.props.players.length-1||(t=!1),t},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this,a=[].concat(Object(h.a)(this.props.player.tableau),[w]);return s.a.createElement("div",{className:this.playerClasses(),ref:this.props.innerRef},s.a.createElement("h1",{className:"name-card"},this.props.player.name),s.a.createElement(f,{character:this.props.player.character,extraClass:(this.characterClickable()?"clickable ":"")+(this.props.that.turnCycle.felix&&this.props.that.turnCycle.felix.some((function(a){return e.props.that.turn===e.props.that.player_id&&a.id===e.props.player.id}))?"selected ":""),playCard:this.characterClickable()?this.props.targets.includes("my-tableau-empty")||this.props.targets.includes("tableau-empty")?function(){e.props.tableauClick(w,e.props.player)}:function(){e.props.characterClick(e.props.player)}:function(){}}),s.a.createElement("div",{className:"tableau"},a.map((function(a,t){return s.a.createElement(y,{key:t,index:t,extraClass:(e.tableauClickable(a)?"clickable ":"")+(e.props.that.turnCycle.cards.some((function(e){return e.id===a.id}))?"selected ":""),player:e.props.player,card:a,playCard:e.tableauClickable(a)?function(){e.props.tableauClick(a,e.props.player)}:function(){}})}))),s.a.createElement("div",{className:"hand"+(this.props.that.showCards?"":" collapsed")},this.props.player.hand.map((function(a,t){var r;return s.a.createElement(y,{myCard:e.props.player.id===e.props.player_id,key:t,index:t,extraClass:(e.handClickable(a)?"clickable ":"")+(e.props.that.turnCycle.cards.some((function(e){return e.id===a.id}))?"selected ":"")+((null===(r=e.props.that.turnCycle["id"+e.props.player.id])||void 0===r?void 0:r.cards.some((function(e){return e.id===a.id})))?"selected ":""),card:a,playCard:e.handClickable(a)?function(){e.props.handClick(a,e.props.player)}:function(){}})}))),s.a.createElement("div",{className:"between-characters"+(this.apparate(this.props.index)?" hasclickable":"")},s.a.createElement("div",{className:"inner-after"+(this.apparate(this.props.index)?" clickable":""),onClick:this.apparate(this.props.index)?function(){e.props.apparate(e.props.index)}:function(){}})))}}]),t}(r.Component)),O=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).myTurn=function(){return!e.props.players[0]["my-turn"]},e.myEvent=function(){var a,t;return e.props.events[0]&&"resolution"!==(null===(a=e.props.events[0])||void 0===a?void 0:a.cardType)&&!(null===(t=e.props.events[0])||void 0===t?void 0:t.target.includes(e.props.player_id))},e.isDrawClickable=function(){return!!e.props.targets.includes("draw")},e.isDiscardClickable=function(){return!!e.props.targets.includes("discard")},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"piles"},s.a.createElement(y,{playCard:this.isDrawClickable()?function(){e.props.deckClick("draw")}:function(){},extraClass:(this.props.deck.cards[0]?"draw":"")+(this.isDrawClickable()?" clickable":""),card:this.props.deck.cards[0]||{name:"",fileName:"",house:""}}),s.a.createElement(y,{playCard:this.isDiscardClickable()?function(){e.props.deckClick("discard")}:function(){},extraClass:"discard "+(this.isDiscardClickable()?"clickable":""),card:this.props.deck.discards[0]||{name:"",fileName:"",house:""}}))}}]),t}(r.Component);function j(e){e=e.toLowerCase().split(" ");for(var a=0;a<e.length;a++)e[a]=e[a].charAt(0).toUpperCase()+e[a].slice(1);return e.join(" ")}function N(e,a){return e.some((function(e){return e.id===a.id}))}function _(e,a){return e.some((function(e){return e.name===a}))}function E(e,a){return void 0!==a.length?e.findIndex((function(e){return a.some((function(a){return e.id===a.id}))})):e.findIndex((function(e){return e.id===a.id}))}function x(e,a){return e.findIndex((function(e){return e.name===a}))}function T(e,a){return e.findIndex((function(e){return e.id===a}))}var A=function(e,a){return e.findIndex((function(e){return e.popup.message.includes(a)}))},S=function(e,a){var t=!1;return e.events&&e.events[0]?e.events[0].target.includes(a.state.player_id)&&e.events[0].popup?t=e.events[0].popup:e.events[0]["bystanders-"+a.state.player_id]?t=e.events[0]["bystanders-"+a.state.player_id]:e.events[0].bystanders&&(t=e.events[0].bystanders):void 0!==e.events&&(t={message:"",options:[]}),t};function D(e,a,t){var r={popup:{message:e,popupType:"resolution",options:[]},cardType:"resolution",target:a};return t&&(r.bystanders={message:t,popupType:"resolution",options:[]}),r}function z(e,a,t,r){var s={popup:{message:e,popupType:"subtle",options:t},cardType:a.character.fileName,target:[a.id]};return r&&(s.bystanders={message:r,popupType:"subtle",options:[]}),s}function M(e,a){var t=[];return e.forEach((function(e){0!==e.character.health||a.includes(e.id)||t.push(e.id)})),t}var Y=function(e){for(var a=["larch_wand","yew_wand","aspen_wand","holly_wand","elder_wand"],t=[],r=0,s=0;s<e.length;s++){if(a.includes(e[s].name)&&r++,r>1)return"You can only have one wand! Discard your current wand first.";if(t.includes(e[s].name))return"azkaban"===e[s].name?"They are already in Azkaban!":"You can only have one "+j(e[s].name.replace("_"," "))+" Discard your current one first.";t.push(e[s].name)}return e.forEach((function(e){})),!1};var H=t(12),R=t(3),P=t.n(R),W=function(e){var a=P()(e.state.players),t=a[T(a,e.state.turn)],r={};if(t.tableau.some((function(e){return"azkaban"===e.name}))){var s=t.tableau.findIndex((function(e){return"azkaban"===e.name})),n=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards));n.serveCard(t.tableau.splice(s,1)[0]),r={players:a,deck:n}}var o=function(e,a,t){var r=P()(e.state.table);if(0===r.length)return!1;var s=a?new v(a.cards,a.discards):new v(e.state.deck.cards,e.state.deck.discards),n={};void 0===t&&(t=r.length);for(var o=t;o>0;o--)s.serveCard(r.splice(r.length-1,1)[0]);return n.table=r,n.deck=s,n}(e,r.deck);return o&&(r=Object.assign(r,o)),t.hand.length>t.character.health?(e.addAlert("You must discard until you have at most the same number of cards as you do health"),!1):r},G=function(e,a){if("unset"===e.state.turnCycle.phase)return e.state.turnCycle;var t={action:"",cards:[],felix:[],draw:2,hotseat:-1,phase:"initial",shots:1,used:[]},r={};console.log(a);var s=e.state.players,n=s[T(s,a)];if(s.forEach((function(e){t["id"+e.id]={cards:[]}})),(_(n.tableau,"elder_wand")||"sirius_black"===n.character.fileName)&&(t.shots=9999),_(n.tableau,"azkaban")){t.phase="azkaban";var o=[{popup:{message:"You\u2019re in Azkaban! Draw a card to see if you get out",options:[],popupType:"subtle"},bystanders:{popupType:"subtle",message:n.character.shortName+" is in Azkaban! They must draw to see if they get out.",options:[]},instigator:n,cardType:"azkaban",target:[a]}];r.events=o}return r.turnCycle=t,r},I=function(e,a){e.action="",e.cards=[],e.felix=[],e.hotseat=-1,e.phase="initial";var t=a.state.players,r=t[T(t,a.state.turn)];return t.forEach((function(a){e["id"+a.id]={choice:"",cards:[]}})),(_(r.tableau,"elder_wand")||"sirius_black"===r.character.fileName)&&(e.shots=9999),e},q=function(e,a,t){for(var r=0;r<t.length;r++){var s="hand",n=E(e.hand,t[r]);-1===n&&(s="tableau",n=E(e.tableau,t[r])),a.serveCards(e[s].splice(n,1))}},L=t(34),F=function(e,a){var t=Object(L.cloneDeep)(e.state.players),r=t[T(t,e.state.turn)],s=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards));return void 0===a&&(a=Object(L.cloneDeep)(e.state.turnCycle)),q(r,s,a.cards),{players:t,deck:s}},B=function(e){var a=[].concat(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards));e.state.players.forEach((function(e){a.push.apply(a,Object(h.a)(e.hand)),a.push.apply(a,Object(h.a)(e.tableau))}));var t=a.length,r=[],s=[];return a.forEach((function(e){r.includes(e.id)?s.push(e.id):r.push(e.id)})),{length:t,duplicates:t-r.length,catcher:s}},U=function(e,a,t){console.log(e,a,t);var r=e,s=a.indexOf(r);for(++s>=a.length&&(s=0);t.includes(a[s]);)++s>=a.length&&(s=0);return r=a[s]},J=function(e,a){switch(e){case"luna_lovegood":return!0;case"ginny_weasley":if("stupefy"===a||"protego"===a)return!0;default:if("protego"===a)return!0}return!1},Q=function(e){var a;if(null===(a=e.state.turnCycle["id"+e.state.player_id])||void 0===a?void 0:a.cards[0]){var t=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards)),r=P()(e.state.players),s=r[T(r,e.state.player_id)],n=e.state.turnCycle["id"+e.state.player_id].cards,o=!1,i="Wahoo!";if(n.length>2);else if(2===n.length)"bellatrix_lestrange"===e.state.events[0].instigator.character.name?n.reduce((function(e,a){var t=e||!0;return"boolean"!==typeof t&&(t=J(s.character,t.name)),t===J(s.character,t.name)}))?o=!0:(o=!1,i="Both cards must be (or work as) protego cards!"):(o=!1,i="You only need to play one card!");else{var c;J(s.character,null===(c=n[0])||void 0===c?void 0:c.name)?o=!0:i="You must play a card that works as a protego charm!"}if(!o)return e.addAlert(i),!1;if(o)return q(s,t,n),{state:{players:r,deck:t},resolve:!0}}else e.addAlert("Choose a protego card first!")},V=function(e){var a=P()(e.state.players);return a[T(a,e.state.player_id)].character.health--,{state:{players:a},resolve:!0}},K=function(e,a){var t=new v(Object(h.a)(a.cards),Object(h.a)(a.discards)),r={G:"Griffindor",S:"Slytherine",H:"Hufflepuff",R:"Ravenclaw"};t.serveCard(t.drawCard());var s=!1,n=r[t.discards[0].house];return e.forEach((function(e){t.discards[0].house===e&&(s=!0,n=r[e])})),{gotit:s,house:n,deck:t}},X=function(e,a){var t=Object(h.a)(e.state.players),r=t[T(t,e.state.player_id)].character.house,s=e.state.turnOrder.indexOf(e.state.player_id)-1;s<0&&(s+=e.state.turnOrder.length),""===r&&(r=e.state.players[e.findMe(e.state.turnOrder[s])].character.house),""===r&&(r="H");var n=P()(e.state.events),o=n[0].popup.options,i=K([r],e.state.deck,e.state.table);return i.gotit?(e.addAlert("Hooray! You drew a "+i.house+", and the spell missed"),{state:{deck:i.deck},resolve:!0}):(o.splice(a,1),e.addAlert("Bummer! You drew a "+i.house+"."),{state:{events:n,deck:i.deck},resolve:!1})},$={primary:function(e,a,t){var r=F(a,t),s=r.players[T(r.players,a.state.turn)];t.shots--;var n=[{label:"Take a hit",function:"takeHit"},{label:"Play Protego",function:"playProtego"}];return n=function(e,a){var t=[],r=Object(h.a)(a);if(r.length>2)return r;for(var s=0;s<e.tableau.length;s++)t.push(e.tableau[s].name);return e.power.includes("mundungus_fletcher")&&r.push({label:"Try to hide as Mundungus",function:"houseHide"}),t.includes("vanishing_cabinet")&&r.push({label:"Try to hide in your vanishing cabinet!",function:"houseHide"}),t.includes("invisibility_cloak")&&r.push({label:"Try to hide with your invisibility cloak!",function:"invisibilityHide"}),t.includes("vanishing_cabinet")&&t.includes("invisibility_cloak")&&(r=[{label:"Hide, invisible, in your vanishing cabinet.",function:"clearEvent"}]),r}(e,n),{state:{events:[Object(H.a)({popup:{message:s.character.shortName+" has fired a stupefy at you!",options:Object(h.a)(n)},instigator:s,cardType:"stupefy",target:[e.id],bystanders:{message:s.character.shortName+" has fired a stupefy at "+e.character.shortName+"!",options:[],popupType:"subtle"}},"bystanders"+s.id,{message:"You have fired a stupefy at "+e.character.shortName+"!",options:[],popupType:"subtle"})],players:r.players,deck:r.deck},resolve:!1}},takeHit:V,playProtego:Q,houseHide:X,invisibilityHide:function(e,a){var t=Object(h.a)(e.state.players),r=t[T(t,e.state.player_id)].character.house,s=e.state.turnOrder.indexOf(e.state.player_id)-1;s<0&&(s+=e.state.turnOrder.length),""===r&&(r=e.state.players[e.findMe(e.state.turnOrder[s])].character.house),""===r&&(r="H");var n=["H","S","G","R"];n.splice(n.indexOf(r),1);var o=P()(e.state.events),i=o[0].popup.options,c=K(n,e.state.deck,e.state.table);return c.gotit?(e.addAlert("Hooray! You drew a "+c.house+", and the spell missed"),{state:{deck:c.deck},resolve:!0}):(i.splice(a,1),e.addAlert("Bummer! You drew a "+c.house+"."),{state:{events:o,deck:c.deck},resolve:!1})},clearEvent:function(){return console.log("Woosh!"),{state:{},resolve:!0}},resolution:function(e,a){var t=e.state.players[T(e.state.players,e.state.turn)],r=e.state.players[T(e.state.players,e.state.turnCycle.hotseat)],s="",n="";switch(a){case"houseHide":s="You have successfully hidden and the spell missed",n=r.character.shortName+" has hidden in their vanishing cabinet and "+t.character.shortName+"\u2019s stupefy missed.";break;case"takeHit":s="You have taken a hit!",n=r.character.shortName+" has been hit by "+t.character.shortName+"\u2019s stupefy.";break;case"playProtego":s="You have successfully cast a protego",n=r.character.shortName+" used a Protego charm and blocked "+t.character.shortName+"\u2019s Stupefy.";break;case"invisibilityHide":s="You have successfully hidden and the spell missed",n=r.character.shortName+" has hidden in their invisibility cloak and "+t.character.shortName+"\u2019s stupefy missed.";break;case"clearEvent":s="The spell missed",n=r.character.shortName+" is untouchable and "+t.character.shortName+"\u2019s stupefy missed."}return{event:D(s,[r.id],n)}}},Z={primary:function(e,a,t,r){var s=P()(t.state.players),n=s[T(s,e.id)],o=s[T(s,t.state.player_id)],i=new v(t.state.deck.cards,t.state.deck.discards),c=N(n.hand,a),l=P()(t.state.events);i.serveCards(n[c?"hand":"tableau"].splice(E(n[c?"hand":"tableau"],a),1)),i.serveCards(o.hand.splice(E(o.hand,r.cards[0]),1));var u=o.character.shortName+" discarded your "+j(a.name.replace("_"," "))+".",d=o.character.shortName+" discarded "+n.character.shortName+"\u2019s "+j(a.name.replace("_"," "))+".",p=D(u,[n.id],d);return l.push(p),{state:{events:l,deck:i,players:s},resolve:!0}}},ee={primary:function(e,a,t,r){var s=F(t,r),n=s.players[T(s.players,e.id)],o=s.players[T(s.players,t.state.player_id)],i=N(n.hand,a),c=P()(t.state.events);o.hand.unshift(n[i?"hand":"tableau"].splice(E(n[i?"hand":"tableau"],a),1)[0]);var l=o.character.shortName+" used a summoning charm to steal your "+j(a.name.replace("_"," "))+".",u=o.character.shortName+" used a summoning charm to steal "+(i?" from ":"")+n.character.shortName+"\u2019s "+(i?" hand.":j(a.name.replace("_"," "))+"."),d=D(l,[n.id],u);return d["bystanders-"+o.id]={popupType:"resolution",message:u.replace(o.character.shortName,"You"),options:[]},c.push(d),{state:{events:c,deck:s.deck,players:s.players},resolve:!0}}},ae={primary:function(e,a,t){var r=F(a,t),s=r.players[T(r.players,e.id)],n=P()(a.state.events);if(s.character.health>=s.character.maxHealth)return a.addAlert("You\u2019re already at max health!"),!1;s.character.health++,s.power.includes("rubeus_hagrid")&&s.character.health>=s.character.maxHealth&&s.character.health++;var o=s.character.shortName+" drank butterbeer and was healed for 1 point!",i=D("You drank butterbeer and were healed for 1 point!",[s.id],o);return n.push(i),{state:{events:n,players:r.players,deck:r.deck},resolve:!0}}},te=function(e){var a=P()(e.state.players),t=a[T(a,e.state.player_id)],r=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards)),s=e.state.turnCycle["id"+e.state.player_id].cards;if(s[0]){var n=function(e,a){if(a.length>1)return{success:!1,alert:"choose only one card!"};switch(e){case"ginny_weasley":if("stupefy"===a[0].name||"protego"===a[0].name)return{success:!0,alert:""};default:if("stupefy"===a[0].name)return{success:!0,alert:""}}return{success:!1,alert:"You must choose a stupefy card!"}}(t.character.name,s);if(n.success)return q(t,r,s),{state:{players:a,deck:r},resolve:!0};e.addAlert(n.alert)}else e.addAlert("Choose a stupefy card first!");return!1},re={primary:function(e,a,t){var r=F(a,t),s=r.players[T(r.players,a.state.turn)],n=[];a.state.players.forEach((function(e,t){e.id!==s.id&&(a.state.deadPlayers.includes(e.id)||_(e.tableau,"expecto_patronum")||n.push(e.id))}));var o={popup:{message:"Dementors attack! Play a Stupefy card to fight them off!",options:[{label:"Take a hit",function:"takeHit"},{label:"Play a stupefy",function:"playStupefy"}]},bystanders:{popupType:"subtle",message:"Whoosh, you\u2019re past the Dementors now!",options:[]},instigator:s,cardType:"dementors",target:[].concat(n)};t.phase="attack";var i=Object(h.a)(a.state.events);return i.push(o),{state:{events:i,players:r.players,deck:r.deck},resolve:!1}},takeHit:V,playStupefy:te,resolution:function(e,a){e.state.players[T(e.state.players,e.state.turn)];var t=e.state.players[T(e.state.players,e.state.player_id)],r=[];e.state.players.forEach((function(a){var t;console.log(e.state.turnCycle["id"+a.id]),"takeHit"===(null===(t=e.state.turnCycle["id"+a.id])||void 0===t?void 0:t.choice)&&r.push(a.character.shortName)}));var s="The Dementors have past. ";return console.log(r),1===r.length?s+=r[0]+" took damage.":2===r.length?s+=r[0]+" and "+r[0]+" both took damage.":r.length>2&&(s+=r.slice(0,-1).join(", ")+", and "+r.slice(-1)+" all took damage."),{event:D(s,[t.id],s)}}},se={primary:function(e,a,t){var r=F(a,t),s=r.players[T(r.players,a.state.turn)],n=[];a.state.players.forEach((function(e,t){a.state.deadPlayers.includes(e.id)||n.push(e.id)}));var o={popup:{message:"Garrotting Gas! Play a Protego card to protect yourself!",options:[{label:"Take a hit",function:"takeHit"},{label:"Cast Protego",function:"playProtego"}]},bystanders:{popupType:"subtle",message:"Whoosh, you\u2019re safe now!",options:[]},instigator:s,cardType:"garroting_gas",target:[].concat(n)};t.phase="attack";var i=Object(h.a)(a.state.events);return i.push(o),{state:{events:i,players:r.players,deck:r.deck},resolve:!1}},takeHit:V,playProtego:Q,resolution:function(e,a){e.state.players[T(e.state.players,e.state.turn)];var t=e.state.players[T(e.state.players,e.state.player_id)],r=[];e.state.players.forEach((function(a){var t;console.log(e.state.turnCycle["id"+a.id]),"takeHit"===(null===(t=e.state.turnCycle["id"+a.id])||void 0===t?void 0:t.choice)&&r.push(a.character.shortName)}));var s="The gas is cleared. ";return console.log(r),1===r.length?s+=r[0]+" took damage.":2===r.length?s+=r[0]+" and "+r[0]+" both took damage.":r.length>2&&(s+=r.slice(0,-1).join(", ")+", and "+r.slice(-1)+" all took damage."),{event:D(s,[t.id],s)}}},ne={primary:function(e,a,t){var r=F(a,t),s=r.players[T(r.players,a.state.player_id)];t.draw+=2;var n=s.character.shortName+"has played Honeydukes and gets to draw two more cards",o=[D("You have played Honeydukes and get to draw two more cards",[s.id],n)];return{state:{players:r.players,deck:r.deck,events:o},resolve:!0}}},oe={primary:function(e,a,t){var r=F(a,t),s=r.players[T(r.players,a.state.player_id)];t.draw+=3;var n=s.character.shortName+"has played Weasleys\u2019 Wizard Weezes and gets to draw three more cards",o=[D("You have played Weasleys\u2019 Wizard Weezes and get to draw three more cards!",[s.id],n)];return{state:{players:r.players,deck:r.deck,events:o},resolve:!0}}},ie={primary:function(e,a,t){for(var r=F(a,t),s=r.players[T(r.players,a.state.turn)],n=[],o=P()(a.state.table),i=a.state.turnOrder,c=a.state.deadPlayers,l=0;l<i.length;l++){var u=l+i.indexOf(a.state.turn);if(u>=i.length&&(u-=i.length),!c.includes(i[u])){o.push(r.deck.drawCard());var d={popup:{popupType:"subtle",message:0===u?"Diagon Alley! Take a card from the table!":s.character.shortName+" has played Diagon Alley! Your turn to take a card!",options:[]},bystanders:{popupType:"subtle",message:0===u?"Everyone else is choosing their cards.":s.character.shortName+" has played Diagon Alley!",options:[]},instigator:s,cardType:"diagon_alley",target:[i[u]]};n.push(d)}}return t.phase="diagon_alley",{state:{players:r.players,deck:r.deck,events:n,table:o},resolve:!1}},secondary:function(e,a,t){var r=P()(a.state.players),s=r[T(r,a.state.player_id)],n=P()(a.state.table),o=P()(a.state.events);s.hand.unshift(n.splice(E(n,e),1)[0]),o.shift();var i=!1;if(0===o.length){var c="All players have taken their cards from Diagon Alley!",l=D(c,[s.id],c);o.unshift(l),i=!0}return{state:{table:n,players:r,events:o},resolve:i}}},ce={primary:function(e,a,t){var r,s=F(a,t),n=s.players[T(s.players,a.state.turn)];return{state:{events:[(r={popup:{message:n.character.shortName+" has challanged you to a Wizard\u2019s Duel!",options:[{label:"Take a hit",function:"takeHit"},{label:"Play Stupefy",function:"duel"}]}},Object(H.a)(r,"bystanders-"+n.id,{popupType:"subtle",message:"You have challenged "+e.character.shortName+" to a Wizard\u2019s Duel!",options:[]}),Object(H.a)(r,"bystanders",{popupType:"subtle",message:n.character.shortName+" has challenged "+e.character.shortName+" to a Wizard\u2019s Duel!",options:[]}),Object(H.a)(r,"instigator",n),Object(H.a)(r,"cardType","wizards_duel"),Object(H.a)(r,"target",[e.id]),r)],players:s.players,deck:s.deck},resolve:!1}},takeHit:V,duel:function(e,a,t){var r,s=te(e);if(!s)return!1;var n=P()(e.state.events),o=s.state.players[T(s.state.players,e.state.player_id)],i=n[0].instigator,c=o.id===s.state.players[T(s.state.players,e.state.turn)].id,l=o.character.shortName+" and "+(c?i.character.shortName:o.character.shortName)+" are fighting a Wizard\u2019s Duel! "+o.character.shortName+" just cast a Stupefy charm at "+i.character.shortName+".",u=(r={popup:{message:o.character.shortName+" has cast a Stupefy back at you!",options:[{label:"Take a hit",function:"takeHit"},{label:"Play Stupefy",function:"duel"}]}},Object(H.a)(r,"bystanders-"+o.id,{popupType:"subtle",message:"You\u2019ve cast a Stupefy at "+i.character.shortName+"!",options:[]}),Object(H.a)(r,"bystanders",{popupType:"subtle",message:l,options:[]}),Object(H.a)(r,"instigator",o),Object(H.a)(r,"cardType","wizards_duel"),Object(H.a)(r,"target",[i.id]),r);return n.shift(),n.push(u),t["id"+e.state.player_id].cards=[],{state:Object.assign(s.state,{events:n}),resolve:!1}},resolution:function(e,a){var t=e.state.players,r=t[T(t,e.state.events[0].instigator.id)],s=t[T(t,e.state.events[0].target[0])],n="You beat "+s.character.shortName+" in a Wizard\u2019s Duel.",o=r.character.shortName+" beat you in a Wizard\u2019s Duel.",i=r.character.shortName+" beat "+s.character.shortName+" in a Wizard\u2019s Duel.",c=D(n,[r.id],i);return c["bystanders-"+s.id]={popupType:"resolution",message:o,options:[]},{event:c}}},le={primary:function(e,a,t){var r=F(a,t),s=r.players[T(r.players,a.state.turn)],n=P()(a.state.events);r.players.forEach((function(e){e.character.health<e.character.maxHealth&&e.character.health++}));var o=s.character.shortName+" played the Three Broomsticks and everyone has been healed for 1 point!",i=D("You played the Three Broomsticks and everyone has been healed for 1 point!",[s.id],o);return n.push(i),{state:{events:n,players:r.players,deck:r.deck},resolve:!0}}},ue=t(203),de=" is about to die. Would you like to give up a life point to save them?",pe={werewolf:" was a werewolf and has been defeated!","death eater":" was a Death Eater and has been defeated. Hooray for the Ministry!",auror:" was an honorable Auror and has been stuck down. The Dark Mark hovers in the sky!"},he={primary:function(e,a,t,r){var s,n=Object(h.a)(e.state.deadPlayers),o=(e.state.turnOrder,P()(a.players)),i=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards)),c=P()(a.events),l=[],u=[],d=function(){return{deadPlayers:n,players:o,deck:i,events:c}};(null===(s=t.afterDeath)||void 0===s?void 0:s.phase)||(t.afterDeath={phase:t.phase,action:t.action}),o.forEach((function(e){n.includes(e.id)||(0!==e.character.health?e.power.some((function(e){return["voldemort","lily_potter","dolores_umbridge"].includes(e)}))&&u.push(e):l.push(e))}));for(var p=function(a){t.phase="death",t.action="death";var s=l[a];if(_(s.hand,"butterbeer"))return i.serveCards(s.hand.splice(x(s.hand,"butterbeer"))),s.character.health++,c.push(D("You drank a butterbeer and were spared from death.",[s.id],s.character.shortName+" drank a butterbeer and was spared from death.")),t.phase=t.afterDeath.phase,t.action=t.afterDeath.action,"continue";if(s.power.includes("harry_potter")&&(!s.character.end||0===s.character.end.deaths))return s.character.end={deaths:1,killer:e.state.turn},s.character.health++,t.phase=t.afterDeath.phase,t.action=t.afterDeath.action,t.afterDeath={},"continue";if(u.forEach((function(e){e.power.includes("lily_potter")&&"lily-skip"!==r&&c.unshift(z(s.character.shortName+de,e,[{label:"Yes",function:"lily_yes"},{label:"No",function:"lily_no"}],e.character.shortName+" has a chance to save "+s.character.shortName+"."))})),function(e){return e.some((function(e){return e.popup.message.includes(de)}))}(c))return{v:d()};if(n.push(s.id),c.push(D("You are now out, but you can still influence the game! As a House Ghost, you may empower another player each turn.",[s.id],s.character.shortName+pe[s.role])),u.forEach((function(e){e.power.includes("voldemort")&&(e.character.health++,e.character.maxHealth++)})),s.hand.length>0){if(s.power.includes("molly_weasley"))return c.unshift(z("You can choose a player to give your cards to or decide to pass.",s,[{label:"skip",function:"molly"}],"Molly has died and is choosing who to will her cards to.")),{v:d()};var o,p=u.findIndex((function(e){return e.power.includes("dolores_umbridge")}));if(-1!==p)(o=u[p].hand).unshift.apply(o,Object(h.a)(s.hand.splice(0)))}i.serveCards(s.hand.splice(0)),i.serveCards(s.tableau.splice(0))},m=0;m<l.length;m++){var y=p(m);switch(y){case"continue":continue;default:if("object"===typeof y)return y.v}}return t.phase=t.afterDeath.phase,t.action=t.afterDeath.action,t.afterDeath={},d()},lily_yes:function(e,a,t){for(var r,s=P()(e.state.players),n=s[T(s,e.state.player_id)],o=e.state.deadPlayers,i=P()(e.state.events),c=0;c<s.length;c++)o.includes(s[c].id)||0===s[c].character.health&&(r=s[c]);for(r.character.health++,n.character.health--,t.phase=t.afterDeath.phase,t.action=t.afterDeath.action,t.afterDeath={};-1!==A(i,r.character.shortName+de);)i.splice(A(i,r.character.shortName+de),1);return i.unshift(D(n.character.shortName+" sacrificed a life point to save your life!",[r.id],n.character.shortName+" sacrificed a life point to save "+r.character.shortName+"\u2019s life.")),{state:{events:i,players:s},resolve:!1}},lily_no:function(e,a,t){var r=P()(e.state.events);return r.shift(),-1!==A(r,e.state.events[0].popup.message)?{state:{events:r},resolve:!1}:{state:he.primary(e,Object.assign(e.state,{events:r}),t,"lily-skip"),resolve:!1}}},me=new Proxy({accio:ee,azkaban:function(e,a){var t=Object(h.a)(e.state.players),r=t[T(t,e.state.player_id)],s=r.character.house,n=e.state.turnOrder.indexOf(e.state.player_id)-1;n<0&&(n+=e.state.turnOrder.length),""===s&&(s=e.state.players[e.findMe(e.state.turnOrder[n])].character.house),""===s&&(s="H");var o=P()(e.state.events),i=K([s],e.state.deck,e.state.table);o.shift();var c={};if(i.gotit){var l="Hooray! You drew a "+i.house+" and escaped Azkaban",u=r.character.shortName+" drew a "+i.house+" and escaped Azkaban";c=D(l,[r.id],u),i.deck.serveCard(r.tableau.splice(x(r.tableau,"azkaban"),1)[0])}else{var d="Bummer! You drew a "+i.house+" and are still in Azkaban. You\u2019ve lost this turn.",p=r.character.shortName+" failed to escape Azkaban and their turn has been skipped.";c=D(d,[r.id],p)}return o.push(c),{state:{events:o,deck:i.deck},gotit:i.gotit,resolve:!0}},discardEvent:{primary:function(e,a){var t=P()(e.state.events),r="Are you sure you want to discard this card?";a.cards.length>1&&(r="Are you sure you want to discard these cards?");var s={popup:{popupType:"subtle",message:r,options:[{label:"yes",function:"dump"},{label:"no",function:"clear"}]},instigator:e.state.players[T(e.state.players,e.state.player_id)],cardType:"discard",target:[e.state.player_id]};return t.push(s),a.phase="discard",a.action="discardEvent",{state:{events:t,turnCycle:a},resolve:!1}},dump:function(e,a,t){var r=P()(e.state.players),s=r[T(r,e.state.player_id)],n=P()(e.state.events),o=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards));return q(s,o,t.cards),n.shift(),I(t,e),{state:{deck:o,players:r,events:n},resolve:!1}},clear:function(e,a,t){var r=P()(e.state.events);return r.shift(),t.phase="selected",1===t.cards.length?t.action=t.cards[0].name:2===t.cards.length&&t.cards.some((function(e){return"stupefy"===e.name}))&&t.cards.some((function(e){return"felix_felicis"===e.name}))?t.action="felix":t.action="discard",{state:{events:r},resolve:!1}}},stupefy:$,expelliarmus:Z,butterbeer:ae,dementors:re,honeydukes:ne,diagon_alley:ie,wizards_duel:ce,weasleys_wizard_weezes:oe,three_broomsticks:le,ressurection_stone:{primary:function(e,a,t){var r=Object(ue.a)(v,[a.state.deck.cards]),s=Object(h.a)(a.state.deck.discards);return t.phase="ressurection_stone-discards",{deck:r,table:s,turnCycle:t}},secondary:function(e,a,t){var r=P()(a.state.players),s=r[T(r,a.state.player_id)],n=Object(h.a)(a.state.table);s.hand.unshift(n.splice(E(n,e))[0]);var o=new v(Object(h.a)(a.state.deck.cards),Object(h.a)(n));n=[];var i=D("You took a "+j(e.name.replace("_"," "))+" from the discard",[s.id],s.character.shortName+" ressurected a card from the discard with the Ressurection Stone"),c=Object(h.a)(a.state.events);return c.push(i),t.used.push("ressurection_stone"),t.draw--,{state:{events:c,deck:o,table:n,players:r},resolve:!0}}},garroting_gas:se,fiendfyre:{primary:function(e,a,t){var r=P()(a.state.events),s=P()(a.state.players),n=s[T(s,a.state.player_id)],o=s[T(s,e.id)];o.tableau.push(n.hand.splice(E(n.hand,t.cards[0]),1)[0]);var i={popup:{message:n.character.shortName+" has cast Fiendfyre at you! Draw a card to see if you make it past",options:[{label:"Draw Card",function:"draw"}],popupType:"subtle"},bystanders:{popupType:"subtle",message:n.character.shortName+" has cast Fiendfyre at "+o.character.shortName+"! They must draw to try to get past.",options:[]},instigator:n,cardType:"fiendfyre",target:[o.id]};return r.push(i),t.phase="attack",t.action="fiendfyre",{state:{events:r,players:s},resolve:!1}},draw:function(e,a,t){var r=X(e,a),s=P()(e.state.events),n=P()(e.state.players),o=n[T(n,s[0].instigator.id)],i=n[T(n,s[0].target[0])],c=i.tableau.splice(E(i.tableau,t.cards[0]),1)[0];if(s.shift(),r.resolve){var l=i.character.shortName+" has extinguished the fiendfyre!",u=D("You have extinguished the fiendfyre!",[i.id],l);return s.push(u),r.state.deck.serveCard(c),I(t,e),{state:{events:s,deck:r.state.deck,players:n},resolve:!1}}i.character.health--;var d=U(i.id,e.state.turnOrder,e.state.deadPlayers),p=n[T(n,d)];p.tableau.push(c);var h={popup:{message:o.character.shortName+" cast Fiendfyre and "+i.character.shortName+" was just burnt!  Draw a card to see if you can extinguish it.",options:[{label:"Draw Card",function:"draw"}]},bystanders:{popupType:"subtle",message:o.character.shortName+" cast Fiendfyre and "+i.character.shortName+" has been burnt! "+p.character.shortName+" must now draw to try to get past.",options:[]},instigator:o,cardType:"fiendfyre",target:[d]};return s.push(h),{state:{events:s,players:n,deck:r.state.deck,resolve:!1}}},resolution:function(e,a){e.state.players[T(e.state.players,e.state.turn)];return{event:D("",[e.state.players[T(e.state.players,e.state.turnCycle.hotseat)].id],"")}}},death:he,felix:{primary:function(e,a,t){var r=T(t.felix,e.id);t.phase="felix",t.felix?t.felix.length<2&&-1===r?t.felix.push(e):-1!==r?t.felix.splice(T(t.felix,e.id),1):a.addAlert("You can only shoot a maximum of two players with Felix Felicis. Deselect another player first."):t.felix=[e];var s=P()(a.state.events),n="Choose one player to cast two spells at or two players to shoot once each.";if(-1===A(s,n)){var o={popup:{popupType:"subtle",message:n,options:[{label:"Stupefy!",function:"shoot"},{label:"X",function:"cancel"}]},instigator:a.state.player_id,cardType:"felix_felicis",target:[a.state.player_id]};s.push(o)}return{state:{events:s},resolve:!1}},shoot:function(e){for(var a=P()(e.state.turnCycle),t=P()(e.state.players),r=t[T(t,e.state.turn)],s=2===a.felix.length?[0,1]:[0,0],n=P()(e.state.events),o=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards)),i=0;i<2;i++)t[T(t,a.felix[s[i]].id)].character.health--;var c=2===a.felix.length?a.felix[0].character.shortName+" and "+a.felix[1].character.shortName+" were both shot by "+r.character.shortName+"\u2019s Felix-fortefied Stupefy.":a.felix[0].character.shortName+" was shot by "+r.character.shortName+"\u2019s Felix-fortefied Stupefy.",l=D(c,[r.id],c);return n.push(l),a.cards.forEach((function(e){var a=r.hand.splice(E(r.hand,e),1)[0];"felix_felicis"!==a.name&&o.serveCard(a)})),a=function(e,a){var t=Object.assign(P()(e),{action:"",cards:[],felix:[],hotseat:-1,phase:"initial"});console.log(t);var r=a.state.players,s=r[T(r,a.state.turn)];return r.forEach((function(e){t["id"+e.id]={choice:"",cards:[]}})),(_(s.tableau,"elder_wand")||"sirius_black"===s.character.fileName)&&(t.shots=9999),t}(a,e),{state:{deck:o,players:t,turnCycle:a,events:n},resolve:!0}},cancel:function(e){var a=P()(e.state.turnCycle),t=P()(e.state.events);return t.shift(),a.phase="selected",a.felix=[],{state:{events:t,turnCycle:a},resolve:!1}},resolution:function(){return"no resolution"}}},{get:function(e,a){return e.hasOwnProperty(a)?e[a]:{primary:function(){return console.log(a+" is not yet defined."),!1}}}}),ye=(t(287),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={},e.classes=function(a){return a.id===e.props.turn?"current-player":e.props.that.deadPlayers.includes(a.id)?"dead":""},e.myTurn=function(){return"initial"===e.props.that.turnCycle.phase&&e.props.turn===e.props.query.id},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"sidebar col-md-4"+(this.props.that.showCards?"":" hidden")},s.a.createElement("div",{className:"sidebar-inner"},s.a.createElement("div",{className:"room-name"},this.props.query.room),s.a.createElement("div",{className:"players"},this.props.players.map((function(a,t){return s.a.createElement("div",{key:a.id,className:e.classes(a)},a.name)}))),s.a.createElement("div",{className:"button"+(this.myTurn()?"":" disabled"),onClick:this.myTurn()?this.props.endTurn:function(){}},"End Turn"),s.a.createElement("div",{className:"role "+this.props.players[0].role.replace(" ","_")})),s.a.createElement("div",{className:"hidebar"},s.a.createElement("div",{className:"inner",onClick:this.props.toggleCards})))}}]),t}(r.Component)),fe=(t(143),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={hidden:!0},e.unhide=function(){e.setState({hidden:!1})},e.hide=function(){e.props.deleteMe(e.props.index)},e}return Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.unhide()}),200)}},{key:"render",value:function(){return s.a.createElement("div",{style:{top:68*this.props.index+10},className:"alert"+(this.state.hidden?" hidden":"")},s.a.createElement("div",{className:"message"},this.props.message),s.a.createElement("div",{className:"a",onClick:this.hide},"close\xa0\xa0\xa0",s.a.createElement("span",{className:"x"})))}}]),t}(r.Component)),ve=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={hidden:!0},e.resolutionLoop=function(){"resolution"!==e.props.actions.popupType||e.state.hidden||e.looping||(e.looping=!0,setTimeout((function(){e.looping=!1,e.hide(),e.resolutionLoop()}),2500))},e.unhide=function(){e.state.hidden&&e.setState({hidden:!1})},e.hide=function(){1===e.props.that.events.length?(e.setState({hidden:!0}),setTimeout((function(){e.props.deleteMe()}),500)):e.props.deleteMe()},e.replaceNames=function(a){return a.replace(e.props.players[0].character.shortName+" has","You have")},e}return Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.unhide(),e.resolutionLoop()}),500)}},{key:"render",value:function(){var e=this;return this.resolutionLoop(),s.a.createElement("div",{className:"alert actions"+(this.props.actions.popupType?" "+this.props.actions.popupType:"")+(this.state.hidden?" hidden":"")},s.a.createElement("div",{className:"message"},this.replaceNames(this.props.actions.message)),this.props.actions.options.map((function(a,t){return s.a.createElement("div",{key:t,className:"a",onClick:e.props.running?function(){return e.props.acFunction(a.function,t)}:function(){e.props.Alert("An error occurred, can you please try that again?")}},a.label)})))}}]),t}(r.Component),be=(t(288),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).tableClickable=function(a){return!(!e.props.targets.includes("table")||""===a.fileName)||!(!e.props.targets.includes("table-empty")||""!==a.fileName)},e.state={},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this,a=this.props.table.length>0?[].concat(Object(h.a)(this.props.table),[w]):[w,w];return s.a.createElement("div",{className:"table"},a.map((function(a,t){return s.a.createElement(y,{key:t,index:t,extraClass:e.tableClickable(a)?"clickable ":"",card:a,playCard:e.tableClickable(a)?function(){e.props.tableClick(a)}:function(){}})})))}}]),t}(r.Component)),ge=t(82),ke=t.n(ge),we=function(e,a){var t=[];switch(e){case"accio":t.push.apply(t,["tableau","hand","range"]);break;case"expelliarmus":t.push.apply(t,["tableau","hand"]);break;case"larch_wand":case"yew_wand":case"aspen_wand":case"holly_wand":case"elder_wand":case"broomstick":case"polyjuice_potion":case"resurrection_stone":case"expecto_patronum":case"vanishing_cabinet":case"invisibility_cloak":t.push.apply(t,["my-tableau-empty","my-character"]);break;case"fiendfyre":case"azkaban":t.push("tableau-empty","characters");break;case"felix":t.push("characters");break;case"apparate":t.push("between-characters");break;case"dementors":case"three_broomsticks":case"honeydukes":case"weasleys_wizard_weezes":case"garroting_gas":case"diagon_alley":t.push("table-empty");break;case"wizards_duel":t.push("characters");break;case"stupefy":a.shots>0&&t.push("characters","wand-range");break;case"butterbeer":t.push("my-character");break;case"three":t.push("characters")}return t},Ce=function(e,a){var t=P()(e),r=[];return a.forEach((function(e){r.push(t[T(t,e)])})),r},Oe=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={},e}return Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"character"},s.a.createElement("div",{className:this.props.character.fileName+" card "+this.props.extraClass+(this.isEmpty(this.props.character.house)?"":this.props.character.house+" "),style:{backgroundImage:"url('/images/stupefy/characters/"+this.props.character.fileName+".jpg')"},onClick:this.props.playCard}))}}]),t}(y),je=(t(321),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={},e.getRoleSentence=function(){var a=", you are ";switch(e.props.player.role){case"minister":a+="the Minister of Magic. You & your Aurors must defeat the Death Eaters and you must survive until the end of the game choose a character that you think will help you the most while you strive to rid the Wizarding World from this brand of evil.";break;case"auror":a+="an Auror of the Ministry of Magic. You must protect the Minister of Magicand help them to defeat the Death Eaters. The Minister must survive until the end of the game and you must insure that they do. Even at great risk to yourself. Choose a character fitting for this task.";break;case"death eater":a+="a Death Eater. Your goal is to, with your fellow Death Eaters, overthrow the Ministry of Magic so you can establish a new world order where Wizards and Witches take their rightful place and rule over the Muggles & Mud-Bloods. Choose a character fitting for this task.";break;case"werewolf":a+="a Werewolf. As an outcast from the Wizarding World, your goal is revenge for all the wrongs done to you. You must destroy all of the other players. Remember, though, that if the Minister dies before all the Death Eaters are dead, then the Death Eaters win & the game ends. Choose a character that will help you effect your goal."}return a},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"choose-character character"},s.a.createElement("div",{className:"holder"},s.a.createElement("div",{className:"title"},"CHOOSE YOUR CHARACTER"),s.a.createElement("div",{className:"briefing"},this.props.player.name+this.getRoleSentence()),this.props.player.character.map((function(a,t){return s.a.createElement(Oe,{key:t,extraClass:"clickable ",character:a,playCard:function(){e.props.chooseCharacter(a)}})}))))}}]),t}(r.Component)),Ne=window.location.origin,_e=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={players:Ce(e.props.setupObj.players,e.props.setupObj.turnOrder),deck:e.props.setupObj.deck,actions:{message:"",options:[]},events:e.props.setupObj.events||[],alerts:[],table:e.props.setupObj.table||[],turn:e.props.setupObj.turn,turnCycle:e.props.setupObj.turnCycle,turnOrder:e.props.setupObj.turnOrder,deadPlayers:e.props.setupObj.deadPlayers||[],player_id:e.props.query.id,player_room:e.props.query.room,running:!0,showCards:!0},e.componentDidMount=function(){e.socket=ke()(Ne),e.socket.emit("join-room",e.state.player_room),e.socket.on("from-the-room",(function(a){e.catchSocket(a)})),e.socket.on("pause",(function(a){console.log(Date.now()-a),e.setState({running:!1})})),e.socket.on("resume",(function(a){console.log(Date.now()-a),e.setState({running:!0})}));var a=B(Object(m.a)(e));console.log("Card count is "+a.length+" with "+a.duplicates+" duplicates: ["+a.catcher+"]");var t=S(e.state,Object(m.a)(e));t&&e.setState({actions:t}),"unset"===e.state.turnCycle.phase&&e.setState({turnCycle:G(Object(m.a)(e),e.state.turn)})},e.pauseRoom=function(){e.socket.emit("pause-room",{room:e.state.player_room,time:Date.now()})},e.resumeRoom=function(){e.socket.emit("resume-room",{room:e.state.player_room,time:Date.now()})},e.catchSocket=function(a){var t=S(a,Object(m.a)(e));t&&(a.actions=t),console.log(a),e.setState(a)},e.addAlert=function(a){var t=[].concat(Object(h.a)(e.state.alerts),[a]);e.setState({alerts:t})},e.deleteAlert=function(a){var t=Object(h.a)(e.state.alerts);t.splice(a,1),e.setState({alerts:t})},e.emitEvent=function(a){e.socket.emit("stupefy",Object.assign({room:e.state.player_room},a));var t=S(a,Object(m.a)(e));t&&(a.actions=t),console.log(a),e.setState(a)},e.nextTurn=function(){var a=W(Object(m.a)(e));if(a){var t=U(e.state.turn,e.state.turnOrder,e.state.deadPlayers),r=G(Object(m.a)(e),t),s=a.players||P()(e.state.players),n=s[T(s,t)];n.power=[n.character.fileName],e.emitEvent(Object.assign(a,{turn:t,players:s},r))}},e.turnOrder=function(){var a=Object(h.a)(e.state.players),t=e.state.turnOrder.indexOf(e.state.player_id),r=a.splice(0,t);return[].concat(Object(h.a)(a),Object(h.a)(r))},e.handClick=function(a,t){var r=P()(e.state.turnCycle);if("initial"===r.phase)return r.cards.push(a),r.phase="selected",r.action=a.name,void e.emitEvent({turnCycle:r});if("stuck-in-azkaban"===r.phase)return r.cards.push(a),r.phase="selected-stuck-in-azkaban",r.action="discard",void e.emitEvent({turnCycle:r});if("selected-stuck-in-azkaban"===r.phase)return N(r.cards,a)?r.cards.splice(E(r.cards,a),1):r.cards.push(a),0===r.cards.length&&(r.phase="stuck-in-azkaban"),void e.emitEvent({turnCycle:r});if("selected"===r.phase){if(t.id===e.state.player_id)return N(r.cards,a)?r.cards.splice(E(r.cards,a),1):(r.cards.push(a),r.action="discard"),2===r.cards.length&&r.cards.some((function(e){return"stupefy"===e.name}))&&r.cards.some((function(e){return"felix_felicis"===e.name}))&&(r.action="felix"),1===r.cards.length&&(r.action=r.cards[0].name),0===r.cards.length&&I(r,Object(m.a)(e)),void e.emitEvent({turnCycle:r});var s=me[r.action].primary(t,a,Object(m.a)(e),r);if(!s)return;if(r.phase="attack",s.resolve)return I(r,Object(m.a)(e)),void e.emitEvent(Object.assign(s.state,{turnCycle:r}))}else if("attack"===r.phase&&t.id===e.state.player_id)return N(r["id"+e.state.player_id].cards,a)?r["id"+e.state.player_id].cards.splice(E(r["id"+e.state.player_id].cards,a),1):r["id"+e.state.player_id].cards.push(a),void e.emitEvent({turnCycle:r})},e.tableauClick=function(a,t){var r=P()(e.state.turnCycle);if("initial"===r.phase)return r.cards.push(a),r.phase="selected-tableau",r.action="discard","resurrection_stone"!==a.name||r.used.includes("ressurection_stone")||(r.phase="ressurection_stone",r.action="ressurection_stone"),void e.emitEvent({turnCycle:r});if("selected-tableau"===r.phase||"ressurection_stone"===r.phase)return t.id===e.state.player_id&&(N(r.cards,a)?r.cards.splice(E(r.cards,a),1):(r.cards.push(a),r.phase="selected-tableau"),1!==r.cards.length||"resurrection_stone"!==r.cards[0].name||r.used.includes("ressurection_stone")||(r.phase="ressurection_stone",r.action="ressurection_stone"),0===r.cards.length&&I(r,Object(m.a)(e))),void e.emitEvent({turnCycle:r});if("selected"===r.phase){if(we(r.action,r).includes("my-tableau-empty")||we(r.action,r).includes("tableau-empty")){var s=P()(e.state.players),n=s[T(s,t.id)],o=s[T(s,e.state.player_id)];if(n.tableau.push(o.hand.splice(E(o.hand,r.cards[0]),1)[0]),"fiendfyre"===r.cards[0].name){var i=me.fiendfyre.primary(t,Object(m.a)(e),r);if(!i)return;return void e.emitEvent(Object.assign(i.state,{turnCycle:r}))}I(r,Object(m.a)(e));var c=Y(n.tableau);return c?void e.addAlert(c):void e.emitEvent({turnCycle:r,players:s})}var l=me[r.action].primary(t,a,Object(m.a)(e),r);if(!l)return;if(r.phase="attack",l.resolve)return I(r,Object(m.a)(e)),void e.emitEvent(Object.assign(l.state,{turnCycle:r}))}},e.characterClick=function(a){var t=P()(e.state.turnCycle);if("selected"===t.phase||"felix"===t.phase){var r=me[t.action].primary(a,Object(m.a)(e),t);if(console.log(t),!r)return;if("selected"===t.phase&&(t.phase="attack"),t.hotseat=a.id,r.resolve)return I(t,Object(m.a)(e)),void e.emitEvent(Object.assign(r.state,{turnCycle:t}));e.emitEvent(Object.assign(r.state,{turnCycle:t}))}},e.tableClick=function(a){var t=P()(e.state.turnCycle),r=!1;if("selected"===t.phase)r=me[t.action].primary(a,Object(m.a)(e),t);else{if("ressurection_stone"===t.phase)return r=me[t.action].primary(a,Object(m.a)(e),t),e.setState(r),void console.log(r);r=me[t.action].secondary(a,Object(m.a)(e),t)}r&&(r.resolve?(I(t,Object(m.a)(e)),e.emitEvent(Object.assign(r.state,{turnCycle:t}))):e.emitEvent(Object.assign(r.state,{turnCycle:t})))},e.deckClick=function(a){var t=P()(e.state.turnCycle),r=P()(e.state.players),s=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards));if("draw"===a){if("initial"===t.phase)return r[T(r,e.state.player_id)].hand.unshift(s.drawCard()),t.draw--,void e.emitEvent({turnCycle:t,deck:s,players:r});if("azkaban"===t.phase){var n=me.azkaban(Object(m.a)(e),t);if(!n)return;return n.gotit?I(t,Object(m.a)(e)):(t.phase="stuck-in-azkaban",setTimeout((function(){e.nextTurn()}),5e3)),void e.emitEvent(Object.assign(n.state,{turnCycle:t}))}}if("discard"===a){var o=me.discardEvent.primary(Object(m.a)(e),t);if(!o)return;e.emitEvent(o.state)}},e.apparate=function(a){var t=P()(e.turnOrder()),r=[],s=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards)),n=P()(e.state.turnCycle),o=t.splice(0,1),i=t.splice(0,a),c=[].concat(Object(h.a)(i),Object(h.a)(o),Object(h.a)(t));c.forEach((function(e){return r.push(e.id)}));var l=c[T(c,e.state.player_id)];q(l,s,n.cards),I(n,Object(m.a)(e));var u=" apparated between "+i[i.length-1].character.shortName+" and "+t[0].character.shortName+".",d=[D("You have"+u,[l.id],l.character.shortName+u)];e.emitEvent({players:c,turnOrder:r,turnCycle:n,deck:s,events:d})},e.actionClick=function(a,t){e.pauseRoom();var r=P()(e.state.turnCycle);r["id"+e.state.player_id].choice=a;var s=me[r.action][a](Object(m.a)(e),t,r);if(s){var n={};if(s.resolve){var o=s.state.events?s.state.events:P()(e.state.events);if(o[0].target.length>1){var i=o[0];i.target.splice(i.target.indexOf(e.state.player_id),1),n.events=o}else{var c=me[r.action].resolution(Object(m.a)(e),a);o.shift(),c.event&&o.unshift(c.event),r.phase="initial",n.events=o}}if(s.state.players)if(M(s.state.players,e.state.deadPlayers).length>0){var l=me.death.primary(Object(m.a)(e),Object.assign(s.state,n),r);n=Object.assign(n,l),console.log(l)}"initial"===r.phase&&I(r,Object(m.a)(e));var u=Object.assign(s.state,n);e.emitEvent(Object.assign(u,{turnCycle:r})),e.resumeRoom()}},e.chooseCharacter=function(a){var t=P()(e.state.players),r=t[T(t,e.state.player_id)],s=new v(Object(h.a)(e.state.deck.cards),Object(h.a)(e.state.deck.discards)),n=P()(e.state.turnCycle);r.character=a,"minister"===r.role&&(r.character.health++,r.character.maxHealth++),r.power.push(r.character.fileName),r.hand=s.drawCards(r.character.health),t.some((function(e){return Array.isArray(e.character)}))||(n.phase="initial"),e.emitEvent({players:t,deck:s,turnCycle:n})},e.clearResolution=function(){var a=P()(e.state.events);a.shift();var t=S({events:a},Object(m.a)(e));e.setState({events:a,actions:t})},e.toggleCards=function(){var a=!e.state.showCards;e.setState({showCards:a})},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this,a=this.turnOrder(),t=this.state.running?function(e){var a,t,r,s=e.state.turnCycle,n=[];if(e.state.turn===e.state.player_id){if("initial"===s.phase||"stuck-in-azkaban"===s.phase)return n.push.apply(n,["my-hand","my-tableau"]),s.draw>0&&n.push("draw"),n;if("selected"===s.phase)return n.push.apply(n,["my-hand","discard"]),n.push.apply(n,Object(h.a)(we(s.action,s))),n;if("felix"===s.phase)return n.push("characters"),n;if("selected-stuck-in-azkaban"===s.phase)return n.push.apply(n,["my-hand","discard"]),n;if("selected-tableau"===s.phase)return n.push.apply(n,["my-tableau","discard"]),n;if("ressurection_stone"===s.action)return"ressurection_stone"===s.phase&&(n.push.apply(n,["my-tableau","discard","characters"]),n.push("table-empty")),"ressurection_stone-discards"===s.phase&&n.push("table"),n}return"attack"!==s.phase||!(null===(a=e.state.events[0])||void 0===a?void 0:a.target.includes(e.state.player_id))&&e.state.player_id!==s.hotseat||n.push("my-hand"),"diagon_alley"===s.phase&&(null===(t=e.state.events[0])||void 0===t?void 0:t.target.includes(e.state.player_id))&&n.push("table"),"azkaban"===s.phase&&(null===(r=e.state.events[0])||void 0===r?void 0:r.target.includes(e.state.player_id))&&n.push("draw"),n}(this):[];return s.a.createElement(s.a.Fragment,null,Array.isArray(a[0].character)?s.a.createElement(je,{chooseCharacter:this.chooseCharacter,player:a[0]}):"",s.a.createElement("div",{className:"alert-holder"},""!==this.state.actions.message?s.a.createElement(ve,{that:this.state,running:this.state.running,Alert:this.addAlert,player_id:this.state.player_id,players:a,actions:this.state.actions,acFunction:this.actionClick,deleteMe:this.clearResolution}):"",this.state.alerts.map((function(a,t){return s.a.createElement(fe,{deleteMe:e.deleteAlert,index:t,key:t,message:a})}))),s.a.createElement("div",{className:"col-md-8"},s.a.createElement(O,{that:this.state,targets:t,deckClick:this.deckClick,deck:this.state.deck}),s.a.createElement(be,{that:this.state,targets:t,tableClick:this.tableClick,table:this.state.table}),a.map((function(r,n){return s.a.createElement(C,{that:e.state,targets:t,player_id:e.state.player_id,key:n,index:n,player:r,players:a,handClick:e.handClick,tableauClick:e.tableauClick,characterClick:e.characterClick,apparate:e.apparate})}))),s.a.createElement(ye,{that:this.state,player_id:this.state.player_id,endTurn:this.nextTurn,boardDeets:this.board,query:this.props.query,players:a,turn:this.state.turn,toggleCards:this.toggleCards}))}}]),t}(r.Component),Ee=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).state={roomname:"",password:"",playername:"",redirect:{value:!1,location:""}},e.handleChange=function(a){e.setState(Object(H.a)({},a.target.name,a.target.value))},e.handleSubmit=function(a){alert("A name was submitted: "+e.state.roomname),a.preventDefault()},e.createRoom=function(){var a="?player="+encodeURIComponent(e.state.playername)+"&room="+encodeURIComponent(e.state.roomname)+(e.state.password?"&pw="+encodeURIComponent(e.state.password):"");console.log("?"+a),fetch("/database/wait/create/"+a).then((function(e){return e.json()})).then((function(a){if(a[0]){var t="?room="+a[0].roomName+"&id="+a[0].players[0].id+"&key="+a[0].password;e.setState({redirect:{value:!0,location:t}})}else console.log("whhyyyy"),e.props.addAlert("This room already exists & in use. Try a different name or go back to join the room.")}))},e.renderRedirect=function(){return s.a.createElement(d.a,{to:"/waiting-room/"+e.state.redirect.location})},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,this.state.redirect.value?this.renderRedirect():"",s.a.createElement("div",{className:"back-button",onClick:function(){e.props.changeToggle("intro")}},"<- Back"),s.a.createElement("div",{className:"info-block"},s.a.createElement("div",{className:"text"},"Enter Your Name:"),s.a.createElement("input",{className:"room-input",name:"playername",type:"text",placeholder:"Moony",autoComplete:"off",value:this.state.value,onChange:this.handleChange})),s.a.createElement("div",{className:"info-block bottom"},s.a.createElement("div",{className:"text"},"Enter Room Details:"),s.a.createElement("input",{className:"room-input",name:"roomname",type:"text",autoComplete:"off",placeholder:"Room Name",value:this.state.value,onChange:this.handleChange}),s.a.createElement("input",{className:"room-input",name:"password",type:"text",autoComplete:"off",style:{marginTop:0},placeholder:"Password? (leave blank for none)",value:this.state.password,onChange:this.handleChange})),s.a.createElement("div",{onClick:this.createRoom,className:"button create"},"create"))}}]),t}(r.Component),xe=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).state={roomname:"",password:"",playername:"",redirect:{value:!1,location:""}},e.handleChange=function(a){e.setState(Object(H.a)({},a.target.name,a.target.value))},e.handleSubmit=function(a){alert("A name was submitted: "+e.state.roomname),a.preventDefault()},e.createRoom=function(){var a="?player="+encodeURIComponent(e.state.playername)+"&room="+encodeURIComponent(e.state.roomname)+(e.state.password?"&pw="+encodeURIComponent(e.state.password):"");console.log("?"+a),fetch("/database/wait/join/"+a).then((function(e){return e.json()})).then((function(a){if(console.log(a),a[0]){if(a[0].error)e.props.addAlert(a[0].error);else{var t="?room="+a[0].roomName+"&id="+a[0].players[a[0].players.length-1].id+"&key="+a[0].password;e.setState({redirect:{value:!0,location:t}})}console.log(a)}else console.log("whhyyyy"),e.props.addAlert("This room doesnt exist! Go back to create it.")}))},e.renderRedirect=function(){return s.a.createElement(d.a,{to:"/waiting-room/"+e.state.redirect.location})},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,this.state.redirect.value?this.renderRedirect():"",s.a.createElement("div",{className:"back-button",onClick:function(){e.props.changeToggle("intro")}},"<- Back"),s.a.createElement("div",{className:"info-block"},s.a.createElement("div",{className:"text"},"Enter Your Name:"),s.a.createElement("input",{autoComplete:"off",className:"room-input",name:"playername",type:"text",placeholder:"Luna",value:this.state.value,onChange:this.handleChange})),s.a.createElement("div",{className:"info-block bottom"},s.a.createElement("div",{className:"text"},"Enter Room Details:"),s.a.createElement("input",{autoComplete:"off",className:"room-input",name:"roomname",type:"text",placeholder:"Room Name",value:this.state.value,onChange:this.handleChange}),s.a.createElement("input",{autoComplete:"off",className:"room-input",name:"password",type:"text",style:{marginTop:0},placeholder:"Password? (leave blank for open rooms)",value:this.state.password,onChange:this.handleChange})),s.a.createElement("div",{onClick:this.createRoom,className:"button create"},"join"))}}]),t}(r.Component),Te=(t(326),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={toggle:"intro",alerts:[]},e.changeToggle=function(a){e.setState({toggle:a})},e.addAlert=function(a){var t=[].concat(Object(h.a)(e.state.alerts),[a]);e.setState({alerts:t})},e.deleteAlert=function(a){var t=Object(h.a)(e.state.alerts);t.splice(a,1),e.setState({alerts:t})},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"create-join"},this.state.alerts.map((function(a,t){return s.a.createElement(fe,{deleteMe:e.deleteAlert,index:t,key:t,message:a})})),s.a.createElement("div",{className:"intro"+("intro"===this.state.toggle?" visible":" hidden")},s.a.createElement("div",{className:"text"},"Would you like to join an existing room or start a new one?"),s.a.createElement("div",{onClick:function(){e.changeToggle("join")},className:"button join"},"join"),s.a.createElement("div",{onClick:function(){e.changeToggle("create")},className:"button create"},"create")),s.a.createElement("div",{className:"create-room"+("create"===this.state.toggle?" visible":" hidden")},s.a.createElement(Ee,{addAlert:this.addAlert,changeToggle:this.changeToggle})),s.a.createElement("div",{className:"join-room"+("join"===this.state.toggle?" visible":" hidden")},s.a.createElement(xe,{addAlert:this.addAlert,changeToggle:this.changeToggle})))}}]),t}(r.Component)),Ae=t(83),Se=t.n(Ae),De=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"waiting-player"+(this.props.id==this.props.player.id?" you":""),onClick:function(){e.props.sendToSocket("Yeah?")}},this.props.player.name)}}]),t}(r.Component),ze=t(205),Me=t.n(ze),Ye=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).state={},e.getName=function(){var a=Object(h.a)(e.props.allPlayers),t=a.findIndex((function(a){return a.id==e.props.message.player}));return-1===t?"unknown":a[t].name},e}return Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"message-container"+(this.props.message.player===this.props.id?" this-player":"")},s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"name"},this.getName()),s.a.createElement("div",{className:"time"},s.a.createElement(Me.a,{format:"h:mm"},this.props.message.time))),s.a.createElement("div",{className:"message"},this.props.message.text))}}]),t}(r.Component),He=t(84),Re=t.n(He),Pe=(t(354),window.location.origin);console.log(Pe),console.log("production");var We=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=a.call.apply(a,[this].concat(n))).state={q:Se.a.parse(e.props.location.search),players:[],filtered_players:[],chat:[],id:0,socket:{sockets:{},users:[]},message:"",gameState:!1,startState:!0},e.componentDidMount=function(){e.socket=ke()(Pe),e.socket.emit("join-waiting-room",{room:e.state.q.room,socketroom:Re()(e.state.q.room)+"-waiting",id:e.state.q.id}),e.socket.on("from-the-waiting-room",(function(a){e.catchSocket(a)}));var a=Pe+"/database/wait/get/",t=e.props.location.search;console.log(t),fetch(a+t).then((function(e){return e.json()})).then((function(a){console.log(a),e.setState({players:a[0].players,chat:a[0].chat}),e.socket.emit("waiting-players",{socketroom:Re()(e.state.q.room)+"-waiting",players:a[0].players})}))},e.componentDidUpdate=function(a,t){if(t.players!==e.state.players||t.socket!==e.state.socket){var r=e.filterPlayer();e.setState({filtered_players:r})}},e.catchSocket=function(a){console.log(a),e.setState(a)},e.sendToSocket=function(a){e.socket.emit("to-waiting-room",{room:e.state.q.room,socketroom:e.state.q.room.replace(" ","-")+"-waiting",info:a})},e.filterPlayer=function(){var a=Object(h.a)(e.state.players),t=[];for(var r in e.state.socket.sockets)t.push(Number(e.state.socket.users[r]));return a.filter((function(e){return t.includes(e.id)}))},e.handleChange=function(a){e.setState(Object(H.a)({},a.target.name,a.target.value))},e.enterChat=function(){if(e.state.message){var a=e.state.message;e.setState({message:""});var t=Object(h.a)(e.state.chat),r={text:a,time:Date.now(),player:e.state.q.id};e.socket.emit("waiting-chat",r),t.push(r),e.setState({chat:t})}},e.startGame=function(){e.state.startState&&e.socket.emit("set-up-game",{room:Re()(e.state.q.room),players:e.state.filtered_players})},e.renderRedirect=function(){return s.a.createElement(d.a,{to:"/play/"+e.props.location.search})},e}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"waiting-room"},this.state.gameState?this.renderRedirect():"",s.a.createElement("header",null,s.a.createElement("div",{className:"stupefy-title"})),s.a.createElement("div",{className:"player-list"},s.a.createElement("h1",null,this.state.q.room),this.state.filtered_players.map((function(a,t){return s.a.createElement(De,{sendToSocket:e.sendToSocket,key:t,player:a,id:e.state.q.id})})),this.state.gameState?s.a.createElement("a",{className:"button"},"go to game"):"",s.a.createElement("div",{onClick:this.startGame,className:"button"+(this.state.startState?"":" disabled")},"start game")),s.a.createElement("div",{className:"chat-box"},s.a.createElement("div",{className:"chats"},this.state.chat.map((function(a,t){return s.a.createElement(Ye,{key:t,id:e.state.q.id,message:a,allPlayers:e.state.players})}))),s.a.createElement("div",{className:"message-input"},s.a.createElement("input",{className:"chat-input",name:"message",type:"text",value:this.state.message,onChange:this.handleChange,autoComplete:"off",onKeyDown:function(a){"Enter"===a.key&&e.enterChat()}}),s.a.createElement("div",{onClick:this.enterChat,className:"button submit-chat"},"\u23ce"))))}}]),t}(r.Component),Ge=(t(355),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(e=a.call.apply(a,[this].concat(s))).getQueryObj=function(){return Se.a.parse(e.props.location.search)},e.state={setupObj:{},q:e.getQueryObj(),isLoaded:!1},e}return Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("/database/players/?room="+Object(L.camelCase)(this.state.q.room)+"&id="+ +this.state.q.id).then((function(e){return e.json()})).then((function(a){a?(console.log(a),e.setState({setupObj:a[0],isLoaded:!0})):e.setState({isLoaded:"no-room"})}),(function(a){e.setState({isLoaded:!0,error:a})}))}},{key:"render",value:function(){var e=this,a=this.state,t=a.error,r=a.isLoaded;if(t)return s.a.createElement("div",null,"Error: ",t.message);if(r){if("no-room"===r)return s.a.createElement("div",{className:"loading"},"This room doesn\u2019t exist!");var n=Object.assign(this.state.q);return n.id=Number(n.id),s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement(_e,{onRef:function(a){return e.board=a},query:n,setupObj:this.state.setupObj})))}return s.a.createElement("div",{className:"loading"},"Loading...")}}]),t}(r.Component));var Ie=function(){var e;return s.a.createElement(p.a,null,"/"===window.location.pathname?(e="welcome",s.a.createElement(d.a,{to:"/"+e})):"",s.a.createElement(d.b,{path:"/welcome/",render:function(e){return s.a.createElement(Te,e)}}),s.a.createElement(d.b,{path:"/waiting-room/",render:function(e){return s.a.createElement(We,e)}}),s.a.createElement(d.b,{path:"/play/",render:function(e){return s.a.createElement(Ge,e)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(621),t(622),t(623);o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(Ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[210,1,2]]]);
//# sourceMappingURL=main.5a8956df.chunk.js.map